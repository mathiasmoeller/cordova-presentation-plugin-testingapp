function PresentationAvailability(e){var n,t=null,o=function(e){n=e.available};exec(o,function(){},"Presentation","getAvailability",[]),Object.defineProperty(this,"onchange",{get:function(){return t},set:function(o){if("function"==typeof o||null===o||void 0===o)if(t=o){var i=function(o){if(n=o.available,o.connection=e,"function"==typeof t){var i=new PresentationConnectionAvailableEvent("connectionavailable",o);t(i)}};exec(i,function(){},"Presentation","addWatchAvailableChange",[])}else exec(function(){},function(){},"Presentation","clearWatchAvailableChange",[])}}),Object.defineProperty(this,"value",{get:function(){return n},set:function(e){n=e}})}function PresentationConnection(e){var n,t=CLOSED,e=e,o=function(){},i=function(){},r=function(){},c=function(){};Object.defineProperty(this,"id",{get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"url",{get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"state",{get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"close",{get:function(){return u(this)}}),Object.defineProperty(this,"terminate",{get:function(){return s(this)}}),Object.defineProperty(this,"send",{get:function(){return a(this)}}),Object.defineProperty(this,"onmessage",{get:function(){return c},set:function(e){"function"!=typeof e&&null!==e||(c=e)}}),Object.defineProperty(this,"onconnect",{get:function(){return o},set:function(e){"function"!=typeof e&&null!==e||(o=e)}}),Object.defineProperty(this,"onclose",{get:function(){return i},set:function(e){"function"!=typeof e&&null!==e||(i=e)}}),Object.defineProperty(this,"onterminate",{get:function(){return r},set:function(e){"function"!=typeof e&&null!==e||(r=e)}});var a=function(e){return function(n){var t=encodeURIComponent(JSON.stringify(n));exec(Function,Function,"Presentation","presentationSessionPostMessage",[e.id,t])}},u=function(e){return function(n){exec(Function,Function,"Presentation","presentationSessionClose",[e.id,CLOSED,n])}},s=function(e){return function(){exec(Function,Function,"Presentation","presentationSessionTerminate",[e.id])}}}function PresentationConnectionAvailableEvent(e,n){this.type=e;var t=n.connection,o=n.available;Object.defineProperty(this,"connection",{get:function(){return t}}),Object.defineProperty(this,"value",{get:function(){return o}})}function PresentationConnectionCloseEvent(e,n){this.type=e;var t=n.message,o=n.reason;Object.defineProperty(this,"message",{get:function(){return t}}),Object.defineProperty(this,"reason",{get:function(){return o}})}function PresentationRequest(e){function n(){return new Promise(function(e,n){exec(function(n){o(n),e(a)},function(e){console.error(e),n(e)},"Presentation","startSession",[a.id])})}function t(e){var n=e||a.id;return new Promise(function(e,t){exec(function(n){o(n),e(a)},function(e){console.error(e),t(e)},"Presentation","reconnectSession",[n])})}function o(e){switch(a.id=e.id,e.eventType){case"onstatechange":i(a,e);break;case"onmessage":if("function"==typeof a.onmessage){var n,t=decodeURIComponent(e.value);try{n=JSON.parse(t)}catch(o){n=t}a.onmessage(n)}}}function i(e,n){switch(e.state=n.value,n.value){case"connected":e.onconnect(e);break;case"connecting":break;case"closed":var t=new PresentationConnectionCloseEvent("close",{message:n.message,reason:n.reason});e.onclose(t);break;case"terminated":e.onterminate(e),e=void 0;break;default:console.error("Unknown connection state: ",n.value)}}function r(){return s=new PresentationAvailability(a),new Promise(function(e,n){u.then(function(){e(s)},function(e){n(e)})})}var c,a,u,s,f;if(!e||""===e)throw new Error("URL must not be empty");"object"==typeof e&&e.length>0&&(e=e[0]);try{c=makeAbs(e)}catch(l){throw new SyntaxError("URL is malformed")}a=new PresentationConnection(c),u=new Promise(function(e,n){exec(function(n){a.id=n.id,e(a)},function(e){throw n(),new Error("Failed to build PresentationRequest",e)},"Presentation","requestSession",[c])}),Object.defineProperty(this,"start",{get:function(){return n}}),Object.defineProperty(this,"reconnect",{get:function(){return t}}),Object.defineProperty(this,"getAvailability",{get:function(){return r}}),Object.defineProperty(this,"onconnectionavailable",{get:function(){return f},set:function(e){if("function"==typeof e||null===e||void 0===e)if(f=e){var n=function(e){if(e.connection=a,"function"==typeof f){var n=new PresentationConnectionAvailableEvent("connectionavailable",e);f(n)}};exec(n,function(){},"Presentation","addWatchAvailableChange",[])}else exec(function(){},function(){},"Presentation","clearWatchAvailableChange",[])}})}var CONNECTING="connecting",CONNECTED="connected",CLOSED="closed",TERMINATED="terminated";PresentationConnectionAvailableEvent.prototype=Event.prototype,PresentationConnectionCloseEvent.prototype=Event.prototype;var execRaw=require("cordova/exec"),cordova=require("cordova"),makeAbs=function(e){var n=null;try{n=new URL(e,location.href).href}catch(t){return t}if(!n){var o=document.createElement("a");o.href=e,n=o.href}return n||(n=e),n},exec=function(){var e=arguments;setTimeout(function(){execRaw.apply(void 0,e)},0)};module.exports=PresentationRequest;